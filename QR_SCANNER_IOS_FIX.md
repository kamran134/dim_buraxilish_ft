# QR Scanner iOS Fix

## Проблема
Приложение вылетало на iOS при попытке открыть QR сканер из-за отсутствия разрешений на использование камеры.

## Исправления

### 1. Добавлены разрешения в Info.plist
В файл `ios/Runner/Info.plist` добавлены обязательные разрешения:
- `NSCameraUsageDescription` - разрешение на использование камеры
- `NSMicrophoneUsageDescription` - разрешение на использование микрофона (требуется некоторыми версиями mobile_scanner)

### 2. Улучшена инициализация сканера
- Добавлена асинхронная инициализация контроллера
- Добавлена проверка mounted перед setState
- Добавлен показ loader'а во время инициализации
- Добавлена обработка ошибок с информативным сообщением

### 3. Обновлена версия mobile_scanner
- Обновлена с `3.5.6` на `4.0.1` для лучшей поддержки iOS
- Версия 4.x имеет улучшенную стабильность на iOS

### 4. Удалены веб-сканеры
Удалены неиспользуемые файлы:
- `web_qr_scanner.dart`
- `web_camera_scanner.dart`
- `simple_web_scanner.dart`

## Как протестировать

1. Полностью удалите приложение с iPhone
2. Пересоберите проект:
   ```bash
   flutter clean
   flutter pub get
   cd ios
   pod install --repo-update
   cd ..
   flutter run
   ```
3. При первом запуске сканера iOS запросит разрешение на камеру
4. Разрешите доступ к камере
5. Сканер должен открыться без проблем

## Важно для iOS

- При первом запуске после установки пользователь ОБЯЗАТЕЛЬНО должен разрешить доступ к камере
- Если пользователь отказал в доступе, нужно будет зайти в Настройки iOS → Приложение → Разрешения и включить камеру
- Описание разрешений в Info.plist должно быть понятным для пользователя (сейчас на азербайджанском языке)

## Дополнительная безопасность

- Добавлена защита от дублирования сканов (debounce 2 секунды)
- Добавлена проверка mounted перед всеми setState
- Улучшена обработка ошибок с graceful degradation
